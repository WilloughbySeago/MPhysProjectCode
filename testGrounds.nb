(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11394,        313]
NotebookOptionsPosition[      9510,        274]
NotebookOutlinePosition[      9968,        291]
CellTagsIndexPosition[      9925,        288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"isWeaklyDecreasing", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", "True"}]], "Input",
 CellChangeTimes->{{3.884758996620743*^9, 3.884759018655696*^9}, {
  3.884759259026018*^9, 3.884759260126914*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"4314c927-46c1-4d70-8b24-a40f9e06eb74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isWeaklyDecreasing", "[", 
   RowBox[{"{", "x_", "}"}], "]"}], ":=", "True"}]], "Input",
 CellChangeTimes->{{3.8847590382111607`*^9, 3.8847590475883665`*^9}, {
  3.884759263888274*^9, 3.8847592659789896`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"fdd13e08-89e2-4ba0-8abd-ed33e7cf4d4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isWeaklyDecreasing", "[", "list_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ">=", 
     RowBox[{"list", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&&", 
   RowBox[{"isWeaklyDecreasing", "[", 
    RowBox[{"list", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8847590236810207`*^9, 3.8847590995832043`*^9}, {
  3.8847591448519325`*^9, 3.8847591633256025`*^9}, {3.8847592698100166`*^9, 
  3.884759281096472*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"6164a796-d389-43e9-b952-85c3b8fc3ab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isYamanouchiWord", "[", "word_List", "]"}], ":=", 
  RowBox[{"isLatticeWord", "[", 
   RowBox[{"Reverse", "[", "word", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884757875796467*^9, 3.884758012005577*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"b5a37d8c-3bf2-4219-84e2-29e302944108"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isLatticeWord", "[", "word_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "prefix", ",", "prefixCount"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"IntegerQ", "/@", "word"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"Positive", "/@", "word"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prefixCount", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Max", "[", "word", "]"}], "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "prepare", " ", "list", " ", "to", " ", "hold", " ", "count", " ", "of",
        " ", "occurrences"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "word", "]"}]}], ",", 
       RowBox[{"i", "+=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"prefixCount", "[", 
          RowBox[{"[", 
           RowBox[{"word", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"isWeaklyDecreasing", "[", "prefixCount", "]"}]}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "True"}]}], 
   "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "if", " ", "we", " ", "reach", " ", "this", " ", "point", " ", "then", 
     " ", 
     RowBox[{"we", "'"}], "ve", " ", "checked", " ", "all", " ", "prefixes", 
     " ", "without", " ", "returning", " ", "false", " ", "and", " ", "the", 
     " ", "word", " ", "is", " ", "a", " ", "lattice", " ", "word"}], " ", 
    "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.884757993614063*^9, 3.884758078905814*^9}, {
  3.8847581193424807`*^9, 3.8847581236400366`*^9}, {3.8847581829971867`*^9, 
  3.884758206171646*^9}, {3.884758259878457*^9, 3.884758368702849*^9}, {
  3.88475865751935*^9, 3.8847589555626655`*^9}, {3.884759194887506*^9, 
  3.8847592461527452`*^9}, {3.884759305692816*^9, 3.884759307315839*^9}, {
  3.884759340474636*^9, 3.8847593608574424`*^9}, {3.8847601873851986`*^9, 
  3.884760347544549*^9}, {3.884760427383581*^9, 3.884760441259611*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"29562ed6-708c-478c-ab79-f645e9ea8937"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"isLatticeWord", "[", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
     "1"}], "}"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Should", " ", "be", " ", "True"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.884758266552311*^9, 3.8847582710803757`*^9}, {
  3.8847584058609266`*^9, 3.8847584157911386`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"2c731fd7-0ebb-4512-a700-19a3e51eddcc"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8847593542583203`*^9, 3.8847593618404884`*^9}, {
  3.884760340057831*^9, 3.8847603508138456`*^9}},
 CellLabel->
  "Out[245]=",ExpressionUUID->"a21046cc-1161-4563-8aa5-8d0c1337bd05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"isLatticeWord", "[", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
     "1"}], "}"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Should", " ", "be", " ", "False"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.884758417640617*^9, 3.8847584460488915`*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"25ce5c7d-5430-440b-ad9d-43495c1ec458"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.884759217590083*^9, 3.8847592489974194`*^9, {3.884759285856922*^9, 
   3.884759362649378*^9}, 3.8847603516680946`*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"cecee514-3b43-41d1-89af-6b39c3a6e5bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"isYamanouchiWord", "[", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
     "1"}], "}"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Should", " ", "be", " ", "True"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.884759365345168*^9, 3.8847593887394443`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"7e24ca8f-1574-4546-9040-45d46796305a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8847593890975285`*^9, 3.8847603526118793`*^9, 
  3.884760436369726*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"07bea401-cff0-4061-bf43-e403dd6e6c1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isLatticeWord", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "3", ",", 
      "3", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "3", ",", 
      "2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "2", ",", "2", ",", "3", ",", "4", ",", "1", ",", 
      "5"}], "}"}]}], "}"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Should", " ", "all", " ", "be", " ", "True"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8847596884665623`*^9, 3.884759753919944*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"b506725a-cd60-463d-9192-500a91990fcc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.8847597235052247`*^9, 3.884759754819682*^9}, 
   3.8847603533717947`*^9, 3.884760434697672*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"ce97bf3c-1942-4db6-bd67-ad73f98449d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isLatticeWord", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
      "3", ",", "3", ",", "3"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "3", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "2", ",", "2", ",", "3", ",", "5", ",", "1", ",", 
      "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], "}"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Should", " ", "all", " ", "be", " ", "False"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8847597561752586`*^9, 3.884759797175149*^9}, {
  3.8847604108391647`*^9, 3.8847604137229133`*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"21b2239d-acef-4ff4-bad0-72267a054fec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.884759784617734*^9, 3.8847603540963297`*^9, {3.8847604146538486`*^9, 
   3.8847604322593946`*^9}},
 CellLabel->
  "Out[252]=",ExpressionUUID->"45d8baf7-1e74-4756-8383-682b006f83f1"]
}, Open  ]]
},
WindowSize->{1440., 741.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
CommonDefaultFormatTypes->{"Output"->StandardForm},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"49ccc6fd-4d13-4242-952a-a551f244215b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 315, 7, 28, "Input",ExpressionUUID->"4314c927-46c1-4d70-8b24-a40f9e06eb74"],
Cell[876, 29, 327, 7, 28, "Input",ExpressionUUID->"fdd13e08-89e2-4ba0-8abd-ed33e7cf4d4a"],
Cell[1206, 38, 684, 18, 28, "Input",ExpressionUUID->"6164a796-d389-43e9-b952-85c3b8fc3ab8"],
Cell[1893, 58, 328, 7, 28, "Input",ExpressionUUID->"b5a37d8c-3bf2-4219-84e2-29e302944108"],
Cell[2224, 67, 2728, 64, 230, "Input",ExpressionUUID->"29562ed6-708c-478c-ab79-f645e9ea8937"],
Cell[CellGroupData[{
Cell[4977, 135, 492, 12, 28, "Input",ExpressionUUID->"2c731fd7-0ebb-4512-a700-19a3e51eddcc"],
Cell[5472, 149, 235, 4, 32, "Output",ExpressionUUID->"a21046cc-1161-4563-8aa5-8d0c1337bd05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5744, 158, 440, 11, 28, "Input",ExpressionUUID->"25ce5c7d-5430-440b-ad9d-43495c1ec458"],
Cell[6187, 171, 258, 5, 32, "Output",ExpressionUUID->"cecee514-3b43-41d1-89af-6b39c3a6e5bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6482, 181, 442, 11, 28, "Input",ExpressionUUID->"7e24ca8f-1574-4546-9040-45d46796305a"],
Cell[6927, 194, 207, 4, 32, "Output",ExpressionUUID->"07bea401-cff0-4061-bf43-e403dd6e6c1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7171, 203, 762, 21, 28, "Input",ExpressionUUID->"b506725a-cd60-463d-9192-500a91990fcc"],
Cell[7936, 226, 293, 6, 32, "Output",ExpressionUUID->"ce97bf3c-1942-4db6-bd67-ad73f98449d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8266, 237, 907, 24, 28, "Input",ExpressionUUID->"21b2239d-acef-4ff4-bad0-72267a054fec"],
Cell[9176, 263, 318, 8, 32, "Output",ExpressionUUID->"45d8baf7-1e74-4756-8383-682b006f83f1"]
}, Open  ]]
}
]
*)

